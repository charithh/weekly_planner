<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Weekly Planner">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#007bff">
    <title>Weekly Planner</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÖ</text></svg>">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDK v9 modular -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        // Make Firebase available globally
        window.firebase = { initializeApp, getFirestore, getAuth };
    </script>
</head>
<body>
    <div class="container">
        <header>
            <div class="week-selector">
                <button id="prevWeek" class="btn btn-nav">‚Äπ Prev</button>
                <div class="week-picker">
                    <h1 id="weekHeader" class="clickable-header">WEEK OF: [DAY OF SUNDAY/ MONTH/YEAR]</h1>
                    <input type="date" id="datePicker" class="date-picker" style="display: none;">
                </div>
                <button id="nextWeek" class="btn btn-nav">Next ‚Ä∫</button>
                <div id="syncStatus" class="sync-status">
                    <span id="syncIndicator" class="sync-indicator offline">‚óè</span>
                    <span id="syncText">Offline</span>
                </div>
                <button id="toggleControls" class="btn btn-controls-toggle" title="Show/Hide Controls">
                    <span class="toggle-icon">‚öôÔ∏è</span>
                    <span class="toggle-text">Controls</span>
                </button>
            </div>
            <div class="controls" id="controlsPanel">
                <button id="addRole" class="btn btn-primary">+ Add Role</button>
                <button id="addGoal" class="btn btn-primary">+ Add Goal Column</button>
                <button id="removeRole" class="btn btn-secondary">- Remove Role</button>
                <button id="removeGoal" class="btn btn-secondary">- Remove Goal Column</button>
                <button id="todayButton" class="btn btn-secondary">Today</button>
                <button id="reminderSettings" class="btn btn-secondary">üîî Reminders</button>
                <button id="hideControls" class="btn btn-hide">‚úï Hide</button>
            </div>
        </header>
        
        <div class="planner-container">
            <table id="plannerTable" class="planner-table">
                <thead>
                    <tr>
                        <th class="role-header">ROLE</th>
                        <th class="goal-header">GOAL</th>
                        <th class="goal-header">GOAL</th>
                        <th class="goal-header">GOAL</th>
                    </tr>
                </thead>
                <tbody id="plannerBody">
                    <tr class="role-row" data-role="individual">
                        <td class="role-cell individual">Individual</td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                    </tr>
                    <tr class="role-row" data-role="husband">
                        <td class="role-cell husband">Husband</td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                    </tr>
                    <tr class="role-row" data-role="father">
                        <td class="role-cell father">Father</td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                    </tr>
                    <tr class="role-row" data-role="engineering-manager">
                        <td class="role-cell engineering-manager">
                            Engineering Manager
                            <ul class="sub-roles">
                                <li>People</li>
                                <li>Process</li>
                                <li>Technology</li>
                                <li>Product</li>
                            </ul>
                        </td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                    </tr>
                    <tr class="role-row" data-role="vpm-toastmaster">
                        <td class="role-cell vpm-toastmaster">VPM - Toastmaster</td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                    </tr>
                    <tr class="role-row" data-role="founder-technology">
                        <td class="role-cell founder-technology">Founder - Technology</td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="planner-container sharpen-section">
            <table class="planner-table">
                <tbody>
                    <tr class="role-row">
                        <td class="role-cell sharpen-saw">SHARPEN THE SAW</td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                        <td class="goal-cell" contenteditable="true" title="Click checkbox to mark complete"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Reminder Settings Modal -->
    <div id="reminderModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîî Daily Goal Reminders</h2>
                <span class="close" id="closeModal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="notification-status" id="notificationStatus">
                    <p>üîï Notifications are disabled</p>
                    <button id="enableNotifications" class="btn btn-primary">Enable Notifications</button>
                </div>
                <div class="reminder-settings" id="reminderSettingsPanel" style="display: none;">
                    <div class="setting-group">
                        <label for="reminderTime">Reminder Time:</label>
                        <input type="time" id="reminderTime" value="09:00">
                    </div>
                    <div class="setting-group">
                        <label>Days to remind:</label>
                        <div class="days-selector">
                            <label><input type="checkbox" id="mon" checked> Mon</label>
                            <label><input type="checkbox" id="tue" checked> Tue</label>
                            <label><input type="checkbox" id="wed" checked> Wed</label>
                            <label><input type="checkbox" id="thu" checked> Thu</label>
                            <label><input type="checkbox" id="fri" checked> Fri</label>
                            <label><input type="checkbox" id="sat"> Sat</label>
                            <label><input type="checkbox" id="sun"> Sun</label>
                        </div>
                    </div>
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enableReminders" checked>
                            Enable daily reminders
                        </label>
                    </div>
                    <div class="modal-actions">
                        <button id="saveReminders" class="btn btn-primary">Save Settings</button>
                        <button id="testNotification" class="btn btn-secondary">Test Notification</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- In-Page Notification System -->
    <div id="inPageNotifications" class="in-page-notifications"></div>
    
    <script type="module" src="firebase-service.js"></script>
    <script src="script.js"></script>
</body>
</html>